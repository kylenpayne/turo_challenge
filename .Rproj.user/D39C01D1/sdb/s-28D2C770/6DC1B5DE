{
    "contents" : "Turo Data Science Case Study Results\n========================================================\nauthor: Kyle N. Payne\ndate: 3/24/2016\n\nIntroduction\n========================================================\n\n- Question 1: What variables influence total number of reservations?\n- Question 2: How does the car's technology type seem to affect reservations?\n- Solution: Random Forests\n\nData\n========================================================\n- Reservations $\\Rightarrow$ Reduced to total reservations per unique id\n- Merged Reservations data with vehicle data\n- Created Target variable\n\n$$\ntotal = \\text{ sum of all reservations for vehicle and res. type}\n$$\n\n```{r, echo=FALSE}\nsource('data.R')\n```\n\n\nExploratory Data Analysis\n========================================================\nTechnology may interact with the total number of reservations, correlation of recommended price and actual price.\n```{r, echo= FALSE}\nlibrary(ggplot2)\nggplot(data_m, aes(x=actual_price, y=recommended_price)) + \n  geom_point(aes(colour=total, size=factor(technology))) + \n  scale_colour_gradient(low = \"darkblue\", high=\"orange\") + \n  theme_bw() + \n  xlab(\"Actual Price\") + \n  ylab(\"Recommended Price\") +\n  geom_hline(yintercept=50, colour='orange', linetype=\"longdash\") + \n  geom_vline(xintercept=50, colour='orange', linetype=\"longdash\")+\n  geom_abline(intercept = 0, colour='orange', linetype='longdash')\n```\n\nExploratory Data Analysis\n========================================================\n\"Instantly Bookable\" vehicles associated with total reservations.\n```{r, echo= FALSE}\nlibrary(ggplot2)\nggplot(data_m, aes(x=actual_price, y=recommended_price)) + \n  geom_point(aes(colour=total, size=factor(technology))) + \n  scale_colour_gradient(low = \"darkblue\", high=\"orange\") + \n  theme_bw() + \n  xlab(\"Actual Price\") + \n  ylab(\"Recommended Price\") +\n  geom_hline(yintercept=50, colour='orange', linetype=\"longdash\") + \n  geom_vline(xintercept=50, colour='orange', linetype=\"longdash\")+\n  geom_abline(intercept = 0, colour='orange', linetype='longdash')\n```\n\nExploratory Data Analysis\n========================================================\n\nWhen \"instantly bookable\" technology is not present, the average \n$actual-recommended$ is larger and more variable!\n```{r, echo= FALSE}\nggplot(data_m, aes(x=factor(technology), y=actual_price-recommended_price)) + \n  geom_boxplot() + \n  theme_bw() + \n  xlab(label = \"Instantly Bookable Technology\") + \n  ylab(\"Difference of Actual Price and Recommended Price\")\n```\n\nMethods\n========================================================\n\n- Random Forests!\n- Simple collection of \"weak learners\"\n- Easy to implement\n\n\nBenefits of Random Forests\n========================================================\n- Tests for feature importance (Question 1)\n- Consistent Model Selection\n- Interaction Detection (Question 2)\n\n\nResults - Variable Importance\n========================================================\nHow much the model suffers when a feature is \"scrambled\".\n```{r, echo=FALSE}\nlibrary(randomForest)\n\nmodl1 <- randomForest(total ~ \n reservation_type*technology*actual_price*recommended_price*num_images*street_parked*description,\n data=data_m, importance=TRUE, mtry=4)\n\nvar_imp <- importance(modl1)\nvar_imp <- data.frame(var_imp)\ncolnames(var_imp) <- c(\"inc_mse\", \"inc_node\")\nvar_imp$var <- row.names(var_imp)\n\n\nggplot(var_imp, aes(x=var, y=inc_mse, group=1)) + \n  geom_point(size=3)+\n  geom_line(colour=\"blue\")+\n  theme_bw() +\n  xlab(\"Feature\") + \n  ylab(\"Percent Increase is Mean Squared Error by Permuted Feature\")\n```\n \nResults - Variable Importance\n========================================================\nRecommended, Actual Prices are most important variables (easy to see why).\n\n```{r, echo=FALSE}\nlibrary(knitr)\nkable(var_imp[,c(1,2)])\n```\n\nResults - Partial Dependence - Actual Price\n========================================================\nAverage dependence of Total Reservations on Actual Price\n```{r, echo=FALSE, fig.height=5}\nlibrary(forestFloor)\ntotal<-data_m[,'total']\nmodel_mat_main <- with(data_m, \n       model.matrix(~reservation_type + technology + actual_price +\n                      recommended_price + num_images + street_parked + description))\nmodel_mat_main <- model_mat_main[,-1]\nmodl2 <- randomForest(x=model_mat_main,y=total,\n                      data=data_m, \n                      importance=TRUE,\n                      mtry=4, \n                      keep.inbag = TRUE)\nff <- forestFloor(rf.fit=modl2, X=model_mat_main)\nCol <- fcol(ff,2,orderByImportance=FALSE) #create color gradient see help(fcol)\nplot(ff,plot_seq=1,col=Col,plot_GOF = FALSE) \n```\n\nBlue = \"Instantly Bookable\", Red  = non-\"Instantly Bookable\"\n\nResults - Partial Dependence - Recommended Price\n========================================================\n```{r, echo=FALSE,message=FALSE, warning=FALSE, fig.height=5}\nplot(ff,plot_seq=2,col=Col, plot_GOF = FALSE) \n```\nBlue = \"Instantly Bookable\", Red = non-\"Instantly Bookable\"\n\nConclusions - Question 1\n========================================================\n\n- Question 1: What variables influence total number of reservations?\n- Actual Price and Recommended Price\n- Evidence includes variable importance measures, and high partial dependence.\n- Highly Correlated\n\nConclusions - Question 2\n========================================================\n\n- Question 2: How does the car's technology type seem to affect reservations? \n- There appear to be a mediating effect of car technology on price (actual and recommended).\n- Cars with \"Instantly Bookable\" technology appear to be reserved more often, yet the\nrecommended price is typically much higher than the actual price for these vehicles.\n\nSuggestions for Future Research\n========================================================\n- Feature Engineering (Actual Price v.s. Recommended Price)\n- Develop feature of price in subspace of price features (PCA)\n- Performance of model on independent test sets.\n- Model Selection.\n\nThanks!\n========================================================",
    "created" : 1458836344074.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1283423450",
    "id" : "6DC1B5DE",
    "lastKnownWriteTime" : 1458849350,
    "path" : "~/Desktop/turo_challenge/turo_slides.Rpres",
    "project_path" : "turo_slides.Rpres",
    "properties" : {
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "type" : "r_presentation"
}